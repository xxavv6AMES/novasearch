<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nova Search - Discover resources, documentation, and tools efficiently">
    <meta name="keywords" content="Nova Search, developer search, coding resources, development tools">
    <meta name="author" content="Novawerks">
    
    <title>Search Results | Nova</title>
    
    <!-- Favicon -->
    <link rel="icon" href="https://cdn.glitch.global/8cdc79c2-e03b-4688-aa5d-1f26e1539764/nova%20(1).ico?v=1732402209810">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Display:wght@400;600&family=Wix+Madefor+Text:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Google Custom Search -->
    <script async src="https://cse.google.com/cse.js?cx=4776225bf1aee432e"></script>

    <!-- External Stylesheet -->
    <link rel="stylesheet" href="results-style.css">
</head>
<body>
    <div class="container">
        <!-- Header with Logo -->
        <header class="logo">
            <a href="index.html">
                <img src="https://cdn.glitch.global/8cdc79c2-e03b-4688-aa5d-1f26e1539764/nova.png?v=1732400592380" alt="Nova Search Logo">
            </a>
        </header>

        <!-- Search Container -->
        <div class="glass-panel">
            <div class="gcse-searchbox-only">
                <gcse:searchbox-only enableautocomplete="true"></gcse:searchbox-only>
            </div>
        </div>

        <!-- Search Results -->
        <main>
            <section class="results">
                <gcse:searchresults-only></gcse:searchresults-only>
            </section>
        </main>

        <!-- Site Footer -->
        <footer>
            <a href="corporate/about.html">About</a>
            <a href="corporate/privacy.html">Privacy</a>
            <a href="corporate/terms.html">Terms &amp; Conditions</a>
            <a href="settings">Settings</a>
        </footer>
    </div>

    <!-- Image Popout Modal -->
    <div id="cseImagePopout" class="cse-image-popout">
        <div class="cse-image-popout-content">
            <span class="cse-image-popout-close">&times;</span>
            <img id="csePopoutImage" class="cse-image-popout-image" src="" alt="Expanded Search Image">
            <div id="cseImageMetadata" class="cse-image-popout-metadata"></div>
        </div>
    </div>

    <!-- Page-Specific Scripts -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const popout = document.getElementById('cseImagePopout');
            const popoutImage = document.getElementById('csePopoutImage');
            const closeButton = document.querySelector('.cse-image-popout-close');
            const metadataContainer = document.getElementById('cseImageMetadata');

            function initializeCSEImagePopout() {
                const imageResults = document.querySelectorAll('.gsc-imageResult img');
                imageResults.forEach(img => {
                    img.style.cursor = 'pointer';
                    img.addEventListener('click', () => {
                        // Set the image source
                        popoutImage.src = img.getAttribute('data-src') || img.src;

                        // Fetch metadata
                        const dimensions = `${img.getAttribute('data-actualwidth')} x ${img.getAttribute('data-actualheight')}`;
                        const link = img.closest('a')?.href || '#';
                        const title = img.closest('a')?.getAttribute('title') || 'Unknown title';
                        const license = img.getAttribute('data-license') || 'Unknown license';
                        const webpage = new URL(link).host || 'Unknown webpage';

                        // Populate metadata
                        metadataContainer.innerHTML = `
                            <p><strong>Dimensions:</strong> ${dimensions}</p>
                            <p><strong>Page Title:</strong> ${title}</p>
                            <p><strong>License Info:</strong> ${license}</p>
                            <p><strong>Web Address:</strong> <a href="${link}" target="_blank" rel="noopener noreferrer">${webpage}</a></p>
                        `;

                        // Show popout
                        popout.classList.add('active');
                    });
                });
            }

            closeButton.addEventListener('click', () => {
                popout.classList.remove('active');
                popoutImage.src = '';
                metadataContainer.innerHTML = '';
            });

            // Observe changes in the results container to reinitialize listeners
            const observer = new MutationObserver(() => initializeCSEImagePopout());
            const resultsContainer = document.querySelector(".results");
            if (resultsContainer) observer.observe(resultsContainer, { childList: true, subtree: true });

            // Disable the default CSE lightbox
            const style = document.createElement('style');
            style.textContent = `
                .gsc-modal-background,
                .gsc-modal-container {
                    display: none !important;
                }
            `;
            document.head.appendChild(style);

            // Ensure all result links open in new tabs
            const linkObserver = new MutationObserver(() => {
                const resultLinks = document.querySelectorAll(".gsc-webResult a");
                resultLinks.forEach(link => {
                    link.setAttribute("target", "_blank");
                    link.setAttribute("rel", "noopener noreferrer");
                });
            });

            if (resultsContainer) {
                linkObserver.observe(resultsContainer, { childList: true, subtree: true });
            }
        });
    </script>
</body>
</html>